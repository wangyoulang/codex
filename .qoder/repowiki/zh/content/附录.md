# 附录

<cite>
**本文档中引用的文件**  
- [config.md](file://docs/config.md)
- [slash_commands.md](file://docs/slash_commands.md)
- [v2.rs](file://codex-rs/app-server-protocol/src/protocol/v2.rs)
- [config_api.rs](file://codex-rs/app-server/src/config_api.rs)
- [error_code.rs](file://codex-rs/app-server/src/error_code.rs)
- [model_provider_info.rs](file://codex-rs/core/src/model_provider_info.rs)
- [env.rs](file://codex-rs/core/src/env.rs)
</cite>

## 目录
1. [配置文件参考](#配置文件参考)
2. [斜杠命令参考](#斜杠命令参考)
3. [环境变量列表](#环境变量列表)
4. [错误代码速查表](#错误代码速查表)

## 配置文件参考

以下是 `config.toml` 文件中所有配置项的完整参考，包括名称、类型、默认值和详细描述。

| 配置项 | 类型/值 | 默认值 | 描述 |
|--------|--------|--------|------|
| `model` | 字符串 | `gpt-5.1-codex-max` | 指定 Codex 使用的模型（例如 `gpt-5.1`, `o3` 等）。 |
| `model_provider` | 字符串 | `openai` | 指定模型提供商的 ID，对应 `model_providers` 映射中的键。 |
| `model_context_window` | 数字 | 根据模型自动确定 | 模型上下文窗口的大小（以 token 为单位）。 |
| `tool_output_token_limit` | 数字 | 2560 | 历史记录中存储的函数/工具输出的 token 预算。 |
| `approval_policy` | `untrusted` \| `on-failure` \| `on-request` \| `never` | `untrusted` | 决定何时提示用户批准执行命令。 |
| `sandbox_mode` | `read-only` \| `workspace-write` \| `danger-full-access` | `read-only` | 操作系统沙箱策略。 |
| `sandbox_workspace_write.writable_roots` | 字符串数组 | `[]` | 在 `workspace-write` 模式下额外的可写根目录。 |
| `sandbox_workspace_write.network_access` | 布尔值 | `false` | 是否允许在 `workspace-write` 模式下进行网络访问。 |
| `sandbox_workspace_write.exclude_tmpdir_env_var` | 布尔值 | `false` | 是否排除 `$TMPDIR` 环境变量指定的目录。 |
| `sandbox_workspace_write.exclude_slash_tmp` | 布尔值 | `false` | 是否排除 `/tmp` 目录。 |
| `notify` | 字符串数组 | 无 | 指定用于接收通知的外部程序。 |
| `tui.animations` | 布尔值 | `true` | 是否启用终端动画（欢迎界面、闪烁效果、旋转器）。 |
| `developer_instructions` | 字符串 | 无 | 额外的开发者指令。 |
| `features.web_search_request` | 布尔值 | `false` | 是否允许模型请求网络搜索。 |
| `features.view_image_tool` | 布尔值 | `true` | 是否启用 `view_image` 工具以查看本地图像文件。 |
| `features.unified_exec` | 布尔值 | `false` | 是否使用统一的 PTY 支持的 exec 工具。 |
| `features.apply_patch_freeform` | 布尔值 | `false` | 是否包含自由格式的 `apply_patch` 工具。 |
| `features.enable_experimental_windows_sandbox` | 布尔值 | `false` | 是否使用 Windows 受限令牌沙箱。 |
| `features.tui2` | 布尔值 | `false` | 是否使用实验性的 TUI v2 实现。 |
| `features.skills` | 布尔值 | `false` | 是否启用技能发现和注入功能。 |
| `mcp_servers.<id>.command` | 字符串 | 无 | MCP 服务器的启动命令（仅限 STDIO 服务器）。 |
| `mcp_servers.<id>.args` | 字符串数组 | 无 | MCP 服务器的参数（仅限 STDIO 服务器）。 |
| `mcp_servers.<id>.env` | 字符串到字符串的映射 | 无 | MCP 服务器的环境变量（仅限 STDIO 服务器）。 |
| `mcp_servers.<id>.url` | 字符串 | 无 | MCP 服务器的 URL（仅限可流式 HTTP 服务器）。 |
| `mcp_servers.<id>.bearer_token_env_var` | 字符串 | 无 | 包含用于身份验证的承载令牌的环境变量（仅限可流式 HTTP 服务器）。 |
| `mcp_servers.<id>.enabled` | 布尔值 | `true` | 是否启用该 MCP 服务器。 |
| `mcp_servers.<id>.startup_timeout_sec` | 数字 | 10 | 启动超时时间（秒）。 |
| `mcp_servers.<id>.tool_timeout_sec` | 数字 | 60 | 每个工具的超时时间（秒）。 |
| `mcp_servers.<id>.enabled_tools` | 字符串数组 | 无 | 限制服务器仅使用列出的工具名称。 |
| `mcp_servers.<id>.disabled_tools` | 字符串数组 | 无 | 在应用 `enabled_tools` 后移除列出的工具名称。 |
| `model_providers.<id>.name` | 字符串 | 无 | 提供商的显示名称。 |
| `model_providers.<id>.base_url` | 字符串 | 无 | API 基础 URL。 |
| `model_providers.<id>.env_key` | 字符串 | 无 | API 密钥的环境变量。 |
| `model_providers.<id>.wire_api` | `chat` \| `responses` | `chat` | 使用的协议。 |
| `model_providers.<id>.query_params` | 字符串到字符串的映射 | 无 | 额外的查询参数（例如 Azure 的 `api-version`）。 |
| `model_providers.<id>.http_headers` | 字符串到字符串的映射 | 无 | 请求中包含的额外静态 HTTP 头。 |
| `model_providers.<id>.env_http_headers` | 字符串到字符串的映射 | 无 | 从环境变量获取值的 HTTP 头。 |
| `model_providers.<id>.request_max_retries` | 数字 | 4 | 对此提供商的 HTTP 请求最大重试次数。 |
| `model_providers.<id>.stream_max_retries` | 数字 | 5 | SSE 流重试次数。 |
| `model_providers.<id>.stream_idle_timeout_ms` | 数字 | 300000 | SSE 空闲超时时间（毫秒）。 |
| `project_doc_max_bytes` | 数字 | 32768 | 从 `AGENTS.md` 文件读取的最大字节数。 |
| `profile` | 字符串 | 无 | 活动配置文件的名称。 |
| `profiles.<name>.*` | 各种类型 | 无 | 配置文件范围的覆盖项。 |
| `history.persistence` | `save-all` \| `none` | `save-all` | 历史文件持久化。 |
| `history.max_bytes` | 数字 | 0（无限制） | `history.jsonl` 文件的最大大小（字节）。 |
| `file_opener` | `vscode` \| `vscode-insiders` \| `windsurf` \| `cursor` \| `none` | `vscode` | 用于可点击引用的 URI 方案。 |
| `tui.notifications` | 布尔值 \| 字符串数组 | `true` | 是否在 TUI 中启用桌面通知。 |
| `tui.scroll_events_per_tick` | 数字 | 终端特定 | 每物理滚轮刻度的原始事件数。 |
| `tui.scroll_wheel_lines` | 数字 | 3 | 每物理滚轮刻度的行数。 |
| `tui.scroll_trackpad_lines` | 数字 | 1 | 触控板模式下的基线灵敏度。 |
| `tui.scroll_trackpad_accel_events` | 数字 | 30 | 触控板加速：TUI2 中每 +1x 速度的事件数。 |
| `tui.scroll_trackpad_accel_max` | 数字 | 3 | 触控板加速：TUI2 中的最大倍增器。 |
| `tui.scroll_mode` | `auto` \| `wheel` \| `trackpad` | `auto` | 如何解释 TUI2 中的滚动输入。 |
| `tui.scroll_wheel_tick_detect_max_ms` | 数字 | 12 | 自动模式下将流提升为滚轮行为的阈值（毫秒）。 |
| `tui.scroll_wheel_like_max_duration_ms` | 数字 | 200 | 自动模式下用于单事件/刻度终端的回退持续时间（毫秒）。 |
| `tui.scroll_invert` | 布尔值 | `false` | 是否反转 TUI2 中的鼠标滚动方向。 |
| `hide_agent_reasoning` | 布尔值 | `false` | 是否隐藏模型推理事件。 |
| `check_for_update_on_startup` | 布尔值 | `true` | 启动时是否检查更新。 |
| `show_raw_agent_reasoning` | 布尔值 | `false` | 是否显示原始推理内容（如果可用）。 |
| `model_reasoning_effort` | `minimal` \| `low` \| `medium` \| `high` \| `xhigh` | `medium` | Responses API 推理努力程度。 |
| `model_reasoning_summary` | `auto` \| `concise` \| `detailed` \| `none` | `auto` | 推理摘要的详细程度。 |
| `model_verbosity` | `low` \| `medium` \| `high` | `medium` | GPT-5 文本详细程度（Responses API）。 |
| `model_supports_reasoning_summaries` | 布尔值 | `false` | 是否强制启用推理摘要。 |
| `chatgpt_base_url` | 字符串 | 无 | ChatGPT 认证流程的基础 URL。 |
| `experimental_instructions_file` | 字符串（路径） | 无 | 替换内置指令（实验性）。 |
| `forced_login_method` | `chatgpt` \| `api` | 无 | 仅允许使用 ChatGPT 或 API 密钥登录。 |
| `forced_chatgpt_workspace_id` | 字符串（UUID） | 无 | 仅允许使用指定的 ChatGPT 工作区。 |
| `cli_auth_credentials_store` | `file` \| `keyring` \| `auto` | `file` | 存储 CLI 登录凭据的位置。 |

**Section sources**
- [config.md](file://docs/config.md)

## 斜杠命令参考

以下是所有可用的斜杠命令及其语法和功能描述。

| 命令 | 语法 | 功能描述 |
|------|------|--------|
| `/model` | `/model <model_name>` | 选择要使用的模型和推理努力程度。 |
| `/approvals` | `/approvals` | 选择 Codex 在无需批准的情况下可以执行的操作。 |
| `/review` | `/review` | 审查当前更改并查找问题。 |
| `/new` | `/new` | 在对话期间开始新的聊天。 |
| `/resume` | `/resume <session_id>` | 恢复旧的聊天。 |
| `/init` | `/init` | 创建一个包含 Codex 指令的 AGENTS.md 文件。 |
| `/compact` | `/compact` | 总结对话以防止达到上下文限制。 |
| `/diff` | `/diff` | 显示 git diff（包括未跟踪的文件）。 |
| `/mention` | `/mention <file_path>` | 提及一个文件。 |
| `/status` | `/status` | 显示当前会话配置和 token 使用情况。 |
| `/mcp` | `/mcp` | 列出配置的 MCP 工具。 |
| `/experimental` | `/experimental` | 打开实验菜单以启用测试计划中的功能。 |
| `/skills` | `/skills` | 浏览和插入技能（实验性）。 |
| `/logout` | `/logout` | 从 Codex 注销。 |
| `/quit` | `/quit` | 退出 Codex。 |
| `/exit` | `/exit` | 退出 Codex。 |
| `/feedback` | `/feedback` | 将日志发送给维护者。 |

**Section sources**
- [slash_commands.md](file://docs/slash_commands.md)

## 环境变量列表

以下是影响 Codex 程序行为的环境变量列表。

| 环境变量 | 描述 |
|----------|------|
| `CODEX_HOME` | 指定 Codex 的主目录，默认为 `~/.codex`。该目录用于存储配置、日志和其他相关文件。 |
| `OPENAI_API_KEY` | 用于 OpenAI 模型提供商的 API 密钥。如果 `model_providers.openai.env_key` 设置为此值，则必须提供此环境变量。 |
| `MISTRAL_API_KEY` | 用于 Mistral 模型提供商的 API 密钥。如果 `model_providers.mistral.env_key` 设置为此值，则必须提供此环境变量。 |
| `AZURE_OPENAI_API_KEY` | 用于 Azure OpenAI 模型提供商的 API 密钥。如果 `model_providers.azure.env_key` 设置为此值，则必须提供此环境变量。 |
| `WT_SESSION` | 当在 Windows Terminal 中检测到 WSL 2 时，Codex 会自动切换到 Windows toast 后端以显示通知。 |
| `CODEX_SANDBOX_NETWORK_DISABLED` | 内部环境变量，指示沙箱网络是否被禁用。此变量由 Codex 自动设置，不可配置。 |
| `WSL_DISTRO_NAME` | 当此环境变量存在时，Codex 会检测到正在运行于 Windows Subsystem for Linux (WSL) 环境中。 |

**Section sources**
- [model_provider_info.rs](file://codex-rs/core/src/model_provider_info.rs)
- [env.rs](file://codex-rs/core/src/env.rs)

## 错误代码速查表

以下是所有可能的错误代码及其含义。

| 错误代码 | 名称 | 含义 |
|---------|------|------|
| -32600 | `INVALID_REQUEST_ERROR_CODE` | 无效的请求。请求不是有效的 JSON 或缺少必需的参数。 |
| -32603 | `INTERNAL_ERROR_CODE` | 内部错误。服务器内部发生错误，无法完成请求。 |
| 1000 | `ConfigLayerReadonly` | 配置层为只读。无法写入指定的配置层。 |
| 1001 | `ConfigVersionConflict` | 配置版本冲突。提供的预期版本与当前版本不匹配。 |
| 1002 | `ConfigValidationError` | 配置验证失败。提供的配置值不符合验证规则。 |
| 1003 | `ConfigPathNotFound` | 配置路径未找到。尝试访问的配置键路径不存在。 |
| 1004 | `ConfigSchemaUnknownKey` | 未知的配置键。提供的配置键不在已知的模式中。 |
| 1005 | `UserLayerNotFound` | 用户层未找到。无法找到用户的配置层进行写入操作。 |

**Section sources**
- [v2.rs](file://codex-rs/app-server-protocol/src/protocol/v2.rs#L416-L424)
- [config_api.rs](file://codex-rs/app-server/src/config_api.rs#L61)
- [error_code.rs](file://codex-rs/app-server/src/error_code.rs#L1-L2)